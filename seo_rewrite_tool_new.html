<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI è‹±æ–‡æ–‡æ¡ˆé‡å†™å·¥å…· (SEOç‰ˆ)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .loader { border: 4px solid #f3f3f3; border-top: 4px solid #10b981; border-radius: 50%; width: 24px; height: 24px; animation: spin 1s linear infinite; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body class="bg-gray-100 min-h-screen py-10 px-4 font-sans">
    <div class="max-w-4xl mx-auto space-y-8">
        <div class="text-center">
            <h1 class="text-3xl font-extrabold text-gray-800 tracking-tight">AI SEO Copy Rewrite</h1>
            <p class="text-gray-500 mt-2">è‹±æ–‡æ–‡æ¡ˆé‡å†™ Â· æ™ºèƒ½åŸ‹è¯ Â· ä¸­æ–‡å¯¹ç…§</p>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
            <div class="md:col-span-2 space-y-6">
                <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-200">
                    <label class="block text-gray-800 font-bold mb-3 flex justify-between">
                        <span>éœ€è¦ä¿®æ”¹çš„åŸå¥ (Source Sentences)</span>
                        <span class="text-xs font-normal text-gray-400">ä¸€è¡Œä¸€å¥ï¼Œå¯æ‰¹é‡è¾“å…¥</span>
                    </label>
                    <textarea id="sourceSentences" rows="6" class="w-full px-4 py-3 rounded-lg bg-gray-50 border border-gray-300 focus:ring-2 focus:ring-green-500 outline-none text-sm" placeholder="ä¾‹å¦‚ï¼š&#10;Where can I buy cheap headphones?&#10;I want to learn coding fast.&#10;This is a good coffee shop."></textarea>
                </div>

                <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-200">
                    <h3 class="text-gray-800 font-bold mb-4">å…³é”®è¯åŸ‹å…¥é…ç½®</h3>
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">ğŸ”¥ å¿…é¡»åŸ‹å…¥ (Mandatory Keywords)</label>
                            <input type="text" id="mandatoryKeywords" class="w-full px-4 py-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-green-500 outline-none text-sm" placeholder="ä¾‹å¦‚ï¼šBest Budget Headphones, 2024 Guide (ç”¨é€—å·åˆ†éš”)">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">ğŸ² æŒ‘é€‰åŸ‹å…¥ (Optional Keywords - AI ä¼šéšæœºé€‰1ä¸ª)</label>
                            <input type="text" id="optionalKeywords" class="w-full px-4 py-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-green-500 outline-none text-sm" placeholder="ä¾‹å¦‚ï¼šAffordable, Cheap, Discount, Low price (ç”¨é€—å·åˆ†éš”)">
                        </div>
                    </div>
                </div>
            </div>

            <div class="space-y-6">
                <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-200">
                    <label class="block text-gray-800 font-bold mb-3">ğŸ”‘ API è®¾ç½® (å¯é€‰)</label>
                    <input type="password" id="userApiKey" class="w-full px-4 py-2 rounded-lg bg-gray-50 border border-gray-300 focus:ring-2 focus:ring-green-500 outline-none text-sm" placeholder="ç•™ç©ºåˆ™ä½¿ç”¨é»˜è®¤é…ç½®ï¼Œå¡«å…¥åˆ™è¦†ç›–">
                </div>

                <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-200">
                    <label class="block text-gray-800 font-bold mb-3">è‡ªå®šä¹‰æŒ‡ä»¤ (Prompt)</label>
                    <textarea id="customInstructions" rows="6" class="w-full px-4 py-3 rounded-lg bg-gray-50 border border-gray-300 focus:ring-2 focus:ring-green-500 outline-none text-sm" placeholder="ä¾‹å¦‚ï¼š&#10;- è¯­æ°”è¦åƒ TikTok ç½‘çº¢&#10;- é‡ç‚¹å¼ºè°ƒâ€œçœé’±â€&#10;- é€‚åˆå‘åœ¨ Instagram caption"></textarea>
                    <p class="text-xs text-gray-400 mt-2 leading-relaxed">AI å°†ä½œä¸ºæ¯è¯­ä¸ºè‹±è¯­çš„ SEO ä¸“å®¶è¿›è¡Œé‡å†™ï¼Œå¹¶è‡ªåŠ¨è¿‡æ»¤ AI ç”Ÿç¡¬è¯ã€‚</p>
                </div>

                <button id="generateBtn" class="w-full bg-green-600 hover:bg-green-700 text-white font-bold py-4 px-6 rounded-xl shadow-lg transition" onclick="generateRewrite()">âš¡ å¼€å§‹é‡å†™æ–‡æ¡ˆ</button>
            </div>
        </div>

        <div id="errorMessage" class="hidden max-w-4xl mx-auto bg-red-50 text-red-600 p-4 rounded-lg text-sm border border-red-200"></div>

        <div id="resultArea" class="hidden bg-white rounded-xl shadow-lg border border-gray-200 overflow-hidden">
            <div class="bg-gray-50 px-6 py-4 border-b border-gray-200 flex justify-between items-center">
                <h3 class="font-bold text-gray-800">âœ¨ é‡å†™ç»“æœ</h3>
                <button onclick="copyResult()" class="text-xs bg-white border border-gray-300 hover:bg-gray-50 text-gray-700 px-3 py-1 rounded">å¤åˆ¶å…¨éƒ¨ç»“æœ</button>
            </div>

            <div class="p-8 overflow-x-auto">
                <table class="min-w-full text-sm border border-gray-300">
                    <thead class="bg-gray-100">
                        <tr>
                            <th class="border p-2">åŸå¥ (Source)</th>
                            <th class="border p-2">è‹±æ–‡é‡å†™ (Rewrite)</th>
                            <th class="border p-2">ä¸­æ–‡ç¿»è¯‘ (Chinese)</th>
                            <th class="border p-2">ä½¿ç”¨çš„å…³é”®è¯ (Keywords)</th>
                        </tr>
                    </thead>
                    <tbody id="resultTableBody"></tbody>
                </table>
            </div>
        </div>
    </div>

<script>
const WORKER_URL = "https://seo-rewrite-worker2.baoyiguo43.workers.dev";

function showError(msg){
    const err = document.getElementById('errorMessage');
    err.textContent = msg;
    err.classList.remove('hidden');
}

function copyResult(){
    const tbody = document.getElementById('resultTableBody');
    const rows = Array.from(tbody.querySelectorAll('tr'));
    if (!rows.length) return;
    const out = rows
        .map(tr => Array.from(tr.querySelectorAll('td')).map(td => td.innerText).join('\t'))
        .join('\n');
    navigator.clipboard.writeText(out);
}

async function generateRewrite(){
    try {
        const source = document.getElementById('sourceSentences').value.trim();
        const mandatory = document.getElementById('mandatoryKeywords').value.trim();
        const optional = document.getElementById('optionalKeywords').value.trim();
        const custom = document.getElementById('customInstructions').value.trim();
        const userApiKey = document.getElementById('userApiKey').value.trim();

        if (!source) return showError('è¯·è¾“å…¥è¦é‡å†™çš„åŸå¥');

        document.getElementById('errorMessage').classList.add('hidden');
        document.getElementById('resultArea').classList.remove('hidden');
        document.getElementById('resultTableBody').innerHTML = "<tr><td class='p-4' colspan='4'>æ­£åœ¨ç”Ÿæˆ...</td></tr>";

        const resp = await fetch(WORKER_URL, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ mandatoryKeywords: mandatory, optionalKeywords: optional, sourceSentences: source, customInstructions: custom, userApiKey: userApiKey || null })
        });

        const data = await resp.json();
        if (data.error) return showError(data.error);

        const text = data.result;
        const blocks = text.split(/---/g).map(b => b.trim()).filter(Boolean);

        const tbody = document.getElementById('resultTableBody');
        tbody.innerHTML = '';

        blocks.forEach(block => {
            const row = { src:'', en:'', zh:'', kw:'' };

            block.split(/\n+/).forEach(line => {
                if (line.startsWith('**åŸå¥:**')) row.src = line.replace('**åŸå¥:**','').trim();
                if (line.startsWith('**è‹±æ–‡é‡å†™:**')) row.en = line.replace('**è‹±æ–‡é‡å†™:**','').trim();
                if (line.startsWith('**ä¸­æ–‡ç¿»è¯‘:**')) row.zh = line.replace('**ä¸­æ–‡ç¿»è¯‘:**','').trim();
                if (line.startsWith('**ä½¿ç”¨çš„å…³é”®è¯:**')) row.kw = line.replace('**ä½¿ç”¨çš„å…³é”®è¯:**','').trim();
            });

            tbody.insertAdjacentHTML('beforeend',`
                <tr>
                    <td class="border p-3 align-top whitespace-pre-line">${row.src}</td>
                    <td class="border p-3 align-top whitespace-pre-line">${row.en}</td>
                    <td class="border p-3 align-top whitespace-pre-line">${row.zh}</td>
                    <td class="border p-3 align-top whitespace-pre-line">${row.kw}</td>
                </tr>
            `);
        });
    } catch (e) {
        showError(e.message);
    }
}
</script>

</body>
</html>
